CREATE DATABASE IF NOT EXISTS RATEME;

USE RATEME;

CREATE TABLE IF NOT EXISTS RATEME.PAIS (
	ID_PAIS INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    POPULACAO DOUBLE NOT NULL
);

CREATE TABLE IF NOT EXISTS RATEME.ESTADO (
	ID_ESTADO INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    POPULACAO DOUBLE NOT NULL,
    PAIS INT NOT NULL,
    CONSTRAINT FK_PAIS FOREIGN KEY (PAIS) REFERENCES RATEME.PAIS (ID_PAIS)
);

CREATE TABLE IF NOT EXISTS RATEME.CIDADE (
	ID_CIDADE INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    POPULACAO DOUBLE NOT NULL,
    ESTADO INT NOT NULL,
    CONSTRAINT FK_ESTADO FOREIGN KEY (ESTADO) REFERENCES RATEME.ESTADO (ID_ESTADO)
);

CREATE TABLE IF NOT EXISTS RATEME.ESTUDIO (
	ID_ESTUDIO INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(50) NOT NULL,
    CIDADE INT NOT NULL,
    ESTADO INT NOT NULL,
    PAIS INT NOT NULL,
    CONSTRAINT FK_CIDADE_ESTUDIO FOREIGN KEY (CIDADE) REFERENCES RATEME.CIDADE (ID_CIDADE),
    CONSTRAINT FK_ESTADO_ESTUDIO FOREIGN KEY (ESTADO) REFERENCES RATEME.ESTADO (ID_ESTADO),
    CONSTRAINT FK_PAIS_ESTUDIO FOREIGN KEY (PAIS) REFERENCES RATEME.PAIS (ID_PAIS)
);

CREATE TABLE IF NOT EXISTS RATEME.DIRETOR (
	ID_DIRETOR INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    IDADE INT NOT NULL,
    NACIONALIDADE INT NOT NULL,
    CONSTRAINT FK_NACIONALIDADE_DIRETOR FOREIGN KEY (NACIONALIDADE) REFERENCES RATEME.PAIS (ID_PAIS)
);

    
CREATE TABLE IF NOT EXISTS RATEME.ATOR (
	ID_ATOR INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    IDADE INT NOT NULL,
    NACIONALIDADE INT NOT NULL,
    CONSTRAINT FK_NACIONALIDADE_ATOR FOREIGN KEY (NACIONALIDADE) REFERENCES RATEME.PAIS (ID_PAIS)
);

CREATE TABLE IF NOT EXISTS RATEME.CATEGORIA (
	ID_CATEGORIA INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    DESCRICAO VARCHAR(30) NOT NULL
);

CREATE TABLE IF NOT EXISTS RATEME.USUARIO (
	ID_USUARIO INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    USERNAME VARCHAR(20) NOT NULL UNIQUE,
    EMAIL VARCHAR(30) NOT NULL UNIQUE,
    DATA_REGISTRO DATE NOT NULL,
    NACIONALIDADE INT NOT NULL,
    CONSTRAINT FK_NACIONALIDADE_USUARIO FOREIGN KEY (NACIONALIDADE) REFERENCES RATEME.PAIS (ID_PAIS)
);

CREATE TABLE IF NOT EXISTS RATEME.FILME (
	ID_FILME INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NOME VARCHAR(30) NOT NULL,
    BILHETERIA DECIMAL(20,2) NOT NULL,
    DATA_LANCAMENTO DATE NOT NULL,
    ESTUDIO INT NOT NULL,
    DIRETOR INT NOT NULL,
    ATOR INT NOT NULL,
    CATEGORIA INT NOT NULL,
    CONSTRAINT FK_ESTUDIO FOREIGN KEY (ESTUDIO) REFERENCES RATEME.ESTUDIO (ID_ESTUDIO),
    CONSTRAINT FK_DIRETOR FOREIGN KEY (DIRETOR) REFERENCES RATEME.DIRETOR (ID_DIRETOR),
    CONSTRAINT FK_ATOR FOREIGN KEY (ATOR) REFERENCES RATEME.ATOR (ID_ATOR),
    CONSTRAINT FK_CATEGORIA FOREIGN KEY (CATEGORIA) REFERENCES RATEME.CATEGORIA (ID_CATEGORIA)
);
    
CREATE TABLE IF NOT EXISTS RATEME.AVALIACAO (
	ID_AVALIACAO INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    DATA_AVALIACAO DATE NOT NULL,
    USUARIO INT NOT NULL,
    FILME INT NOT NULL,
    AVALIACAO VARCHAR(3) NOT NULL,
    CONSTRAINT FK_USUARIO FOREIGN KEY (USUARIO) REFERENCES RATEME.USUARIO (ID_USUARIO),
    CONSTRAINT FK_FILME FOREIGN KEY (FILME) REFERENCES RATEME.FILME (ID_FILME)
);


INSERT INTO RATEME.PAIS VALUES (1,"BRASIL",209000000);
INSERT INTO RATEME.PAIS VALUES (2,"ESTADOS UNIDOS",327000000);
INSERT INTO RATEME.PAIS VALUES (3,"FRANÇA",67000000);
INSERT INTO RATEME.PAIS VALUES (4,"INGLATERRA",56000000);
INSERT INTO RATEME.PAIS VALUES (5,"ESPANHA",47000000);

INSERT INTO RATEME.ESTADO VALUES (1,"RIO DE JANEIRO",6320000,1);
INSERT INTO RATEME.ESTADO VALUES (2,"NOVA IORQUE",20700000,2);
INSERT INTO RATEME.ESTADO VALUES (3,"SAO PAULO",21000000,1);
INSERT INTO RATEME.ESTADO VALUES (4,"LONDRES",8196700,4);
INSERT INTO RATEME.ESTADO VALUES (5,"MADRID",6550000,5);
INSERT INTO RATEME.ESTADO VALUES (6,"CALIFORNIA",33000000,2);

INSERT INTO RATEME.CIDADE VALUES (1,"NITEROI",487000,1);
INSERT INTO RATEME.CIDADE VALUES (2,"NOVA IORQUE",8700000,2);
INSERT INTO RATEME.CIDADE VALUES (3,"SAO PAULO",12200000,1);
INSERT INTO RATEME.CIDADE VALUES (4,"LONDRES",6320000,4);
INSERT INTO RATEME.CIDADE VALUES (5,"MADRID",3300000,5);
INSERT INTO RATEME.CIDADE VALUES (6,"LOS ANGELES",3800000,2);

INSERT INTO RATEME.ESTUDIO VALUES (1,"2OTH CENTURY FOX",6,6,2);
INSERT INTO RATEME.ESTUDIO VALUES (2,"UNIVERSAL STUDIOS",6,6,2);
INSERT INTO RATEME.ESTUDIO VALUES (3,"WARNER BROS. PICTURES",2,2,2);

INSERT INTO RATEME.DIRETOR VALUES (1,"DAVID FINCHER",57,2);
INSERT INTO RATEME.DIRETOR VALUES (2,"STEVEN SPIELBERG",72,2);
INSERT INTO RATEME.DIRETOR VALUES (3,"CHRISTOPHER NOLAN",49,4);

INSERT INTO RATEME.ATOR VALUES (1,"ANNE HATHAWAY",37,2);
INSERT INTO RATEME.ATOR VALUES (2,"RALPH FIENNES",56,4);
INSERT INTO RATEME.ATOR VALUES (3,"EDWARD NORTON",50,2);

INSERT INTO RATEME.CATEGORIA VALUES (1,"AÇÃO");
INSERT INTO RATEME.CATEGORIA VALUES (2,"DRAMA");
INSERT INTO RATEME.CATEGORIA VALUES (3,"FICÇÃO CIENTÍFICA");

INSERT INTO RATEME.USUARIO VALUES (1,"FELIPE VILA CHA","VILACHA","felipevcsantos@hotmaiil.com",'2019-11-23',1);

INSERT INTO RATEME.FILME VALUES (1,"INTERSTELLAR",675000000.00,'2014-10-26',3,3,1,3);
INSERT INTO RATEME.FILME VALUES (2,"CLUBE DA LUTA",101000000.00,'1999-10-29',1,1,3,1);
INSERT INTO RATEME.FILME VALUES (3,"A LISTA DE SCHINDLER",321000000.00,'1993-12-15',2,2,2,2);

INSERT INTO RATEME.AVALIACAO VALUES (1,'2019-11-23',1,1,"5");
INSERT INTO RATEME.AVALIACAO VALUES (2,'2019-11-23',1,2,"4.5");
INSERT INTO RATEME.AVALIACAO VALUES (3,'2019-11-23',1,3,"4.3");